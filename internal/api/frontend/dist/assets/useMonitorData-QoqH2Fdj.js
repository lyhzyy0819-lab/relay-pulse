import{j as e}from"./index-B5LZFFKW.js";import{r as g}from"./router-Bv_Qn1wY.js";import{u as C,i as be}from"./i18n-CHCxKNI1.js";import{A as fe,d as ge,T as ae,E as ve,Z as re,S as le,e as ne,f as ie,g as ye,h as je,i as Ne,X as we}from"./icons-DIKtrEYc.js";function _e({text:t,className:s="",typeSpeed:l=120,deleteSpeed:r=60,pauseAfterType:i=2500,pauseAfterDelete:c=1e3}){const[x,n]=g.useState(""),[b,u]=g.useState("typing"),[o,v]=g.useState(0);return g.useEffect(()=>{let a;return(()=>{switch(b){case"typing":o<t.length?a=setTimeout(()=>{n(t.slice(0,o+1)),v(o+1)},l):a=setTimeout(()=>{u("pause-typed")},i);break;case"pause-typed":a=setTimeout(()=>{u("deleting")},0);break;case"deleting":o>0?a=setTimeout(()=>{n(t.slice(0,o-1)),v(o-1)},r):a=setTimeout(()=>{u("pause-deleted")},c);break;case"pause-deleted":a=setTimeout(()=>{u("typing")},0);break}})(),()=>{a&&clearTimeout(a)}},[b,o,t,l,r,i,c]),g.useEffect(()=>{n(""),v(0),u("typing")},[t]),e.jsxs("span",{className:s,children:[x,e.jsx("span",{className:"animate-cursor",children:"|"}),e.jsx("style",{children:`
        @keyframes cursor-blink {
          0%, 49% { opacity: 1; }
          50%, 100% { opacity: 0; }
        }
        .animate-cursor {
          animation: cursor-blink 1s infinite;
        }
      `})]})}function Ve({stats:t}){const{t:s}=C();return e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4 border-b border-slate-800/50 pb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-1 sm:mb-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-amber-500/10 rounded-lg border border-amber-500/20",children:e.jsx(fe,{className:"w-5 h-5 sm:w-6 sm:h-6 text-amber-400"})}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-amber-400 via-amber-500 to-orange-500",children:e.jsx(_e,{text:"Code-CLI",className:"inline-block min-w-[120px] sm:min-w-[160px]"})})]}),e.jsxs("p",{className:"text-slate-400 text-xs sm:text-sm flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),s("header.tagline")]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:flex gap-2 sm:gap-4",children:[e.jsxs("div",{className:"px-3 sm:px-4 py-2 rounded-xl bg-slate-900/50 border border-slate-800 backdrop-blur-sm flex items-center gap-2 sm:gap-3 shadow-lg",children:[e.jsx("div",{className:"p-1 sm:p-1.5 rounded-full bg-emerald-500/10 text-emerald-400",children:e.jsx(ge,{size:14,className:"sm:w-4 sm:h-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-[10px] sm:text-xs",children:s("header.stats.healthy")}),e.jsx("div",{className:"font-mono font-bold text-emerald-400 text-sm sm:text-base",children:t.healthy})]})]}),e.jsxs("div",{className:"px-3 sm:px-4 py-2 rounded-xl bg-slate-900/50 border border-slate-800 backdrop-blur-sm flex items-center gap-2 sm:gap-3 shadow-lg",children:[e.jsx("div",{className:"p-1 sm:p-1.5 rounded-full bg-rose-500/10 text-rose-400",children:e.jsx(ae,{size:14,className:"sm:w-4 sm:h-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 text-[10px] sm:text-xs",children:s("header.stats.issues")}),e.jsx("div",{className:"font-mono font-bold text-rose-400 text-sm sm:text-base",children:t.issues})]})]})]})]})}const ke=[{id:"88code",name:"88code",services:["cc","cx"]},{id:"xychatai",name:"xychatai",services:["cx"]},{id:"duckcoding",name:"duckcoding",services:["cc","cx"]},{id:"www.right.codes",name:"www.right.codes",services:["cx"]}],J=[{id:"24h",label:"è¿‘24å°æ—¶",points:24,unit:"hour"},{id:"7d",label:"è¿‘7å¤©",points:7,unit:"day"},{id:"30d",label:"è¿‘30å¤©",points:30,unit:"day"}],Ae=t=>[{id:"24h",label:t("controls.timeRanges.24h"),points:24,unit:"hour"},{id:"7d",label:t("controls.timeRanges.7d"),points:7,unit:"day"},{id:"30d",label:t("controls.timeRanges.30d"),points:30,unit:"day"}],O={AVAILABLE:{color:"bg-green-500",text:"text-green-400",glow:"shadow-[0_0_10px_rgba(34,197,94,0.6)]",label:"å¯ç”¨",weight:3},DEGRADED:{color:"bg-green-400",text:"text-green-300",glow:"shadow-[0_0_10px_rgba(74,222,128,0.6)]",label:"æ³¢åŠ¨",weight:2},MISSING:{color:"bg-slate-400",text:"text-slate-400",glow:"shadow-[0_0_10px_rgba(148,163,184,0.4)]",label:"æ— æ•°æ®",weight:1},UNAVAILABLE:{color:"bg-slate-500",text:"text-slate-400",glow:"shadow-[0_0_10px_rgba(107,114,128,0.6)]",label:"ä¸å¯ç”¨",weight:1}},oe=t=>({AVAILABLE:{color:"bg-green-500",text:"text-green-400",glow:"shadow-[0_0_10px_rgba(34,197,94,0.6)]",label:t("status.available"),weight:3},DEGRADED:{color:"bg-green-400",text:"text-green-300",glow:"shadow-[0_0_10px_rgba(74,222,128,0.6)]",label:t("status.degraded"),weight:2},MISSING:{color:"bg-slate-400",text:"text-slate-400",glow:"shadow-[0_0_10px_rgba(148,163,184,0.4)]",label:t("status.missing"),weight:1},UNAVAILABLE:{color:"bg-slate-500",text:"text-slate-400",glow:"shadow-[0_0_10px_rgba(107,114,128,0.6)]",label:t("status.unavailable"),weight:1}}),Se="",F="false".toLowerCase()==="true";function ce({status:t,size:s="md",showLabel:l=!1}){const r={sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4"},i=O[t];return e.jsx("div",{className:`${r[s]} rounded-full ${i.color} ${i.glow} transition-all duration-500`,role:"img","aria-label":i.label,title:l?void 0:i.label,children:e.jsx("span",{className:"sr-only",children:i.label})})}const I={r:107,g:114,b:128},R={r:74,g:222,b:128},$={r:34,g:197,b:94},M={r:148,g:163,b:184};function z(t,s,l){const r=Math.round(t.r+(s.r-t.r)*l),i=Math.round(t.g+(s.g-t.g)*l),c=Math.round(t.b+(s.b-t.b)*l);return`rgb(${r}, ${i}, ${c})`}function G(t){if(t<0)return`rgb(${M.r}, ${M.g}, ${M.b})`;if(t<60)return`rgb(${I.r}, ${I.g}, ${I.b})`;if(t<80){const l=(t-60)/20;return z(I,R,l)}const s=(t-80)/20;return z(R,$,s)}function Ee(t){return{backgroundColor:G(t)}}function q(t,s){if(t<=0||s<=0)return`rgb(${M.r}, ${M.g}, ${M.b})`;const l=t/s;if(l<.3)return`rgb(${$.r}, ${$.g}, ${$.b})`;if(l<1){const r=(l-.3)/.7;return z($,R,r)}if(l<2){const r=(l-1)/1;return z(R,I,r)}return`rgb(${I.r}, ${I.g}, ${I.b})`}const de={mobile:"(max-width: 767px)",tablet:"(max-width: 959px)"};function ue(t,s){return t.addEventListener?(t.addEventListener("change",s),()=>t.removeEventListener("change",s)):t.addListener?(t.addListener(s),()=>t.removeListener(s)):(console.warn("matchMedia listeners not supported"),()=>{})}function Y(t,s){const l=window.matchMedia(de[t]);return s(l.matches),ue(l,i=>{s(i.matches)})}function me({point:t,width:s,height:l="h-8",onHover:r,onLeave:i}){const{t:c}=C(),[x,n]=g.useState(!1);g.useEffect(()=>Y("mobile",n),[]);const b=u=>{u.stopPropagation(),r(u,t)};return e.jsx("div",{role:"button",tabIndex:0,className:`${l} rounded-sm transition-all duration-200 hover:scale-110 active:scale-105 hover:z-10 cursor-pointer opacity-80 hover:opacity-100 active:opacity-100`,style:{width:s,...Ee(t.availability)},onMouseEnter:x?void 0:u=>r(u,t),onMouseLeave:x?void 0:i,onTouchStart:b,onClick:b,onFocus:x?void 0:u=>r(u,t),onBlur:x?void 0:i,"aria-label":t.availability>=0?c("accessibility.uptimeBlock",{uptime:t.availability.toFixed(1)}):c("accessibility.noDataBlock")})}function Te(){return typeof window.gtag=="function"&&!!window.GA_MEASUREMENT_ID}function W(t,s){Te()&&window.gtag("event",t,s)}function K(t,s,l){W("api_request",{endpoint:t,duration:s,success:l})}function Q(t,s,l){W("api_error",{endpoint:t,error_type:s,error_message:l||"Unknown error"})}function P({href:t,children:s,className:l="",trackLabel:r}){if(!t)return e.jsx("span",{className:l,children:s});const i=t.startsWith("http://"),c=()=>{W("click_external_link",{label:r||(typeof s=="string"?s:t),url:t})},x=typeof s=="string"?`è®¿é—® ${s}ï¼ˆåœ¨æ–°çª—å£æ‰“å¼€ï¼‰`:"å¤–éƒ¨é“¾æŽ¥ï¼ˆåœ¨æ–°çª—å£æ‰“å¼€ï¼‰";return e.jsxs("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:`inline-flex items-center gap-1 hover:underline active:underline min-h-[44px] py-1 -my-1 ${l}`,onClick:c,"aria-label":x,children:[s,e.jsx(ve,{size:12,className:"flex-shrink-0","aria-hidden":"true"}),i&&e.jsx("span",{title:"éžåŠ å¯† HTTP é“¾æŽ¥",className:"inline-flex","aria-label":"è­¦å‘Šï¼šéžåŠ å¯†é“¾æŽ¥",children:e.jsx(ae,{size:12,className:"text-amber-500 flex-shrink-0","aria-hidden":"true"})})]})}let H=null,U=null;function Ie(){return typeof window>"u"?!1:(U===null&&(U=window.matchMedia(de.tablet),H=U.matches,ue(U,t=>{H=t.matches})),H??!1)}function Le(t,s=50){if(!Ie()||t.length<=s)return t;const l=Math.ceil(t.length/s),r=[];for(let i=0;i<t.length;i+=l){const c=t.slice(i,i+l),x=Me(c);r.push(x)}return r}function Me(t){if(t.length===0)throw new Error("Cannot aggregate empty group");if(t.length===1)return t[0];const s=t.map(a=>a.availability).filter(a=>a>=0),l=s.length>0?s.reduce((a,y)=>a+y,0)/s.length:-1,r=s.length>0?Math.min(...s):-1,i=s.length>0?Math.max(...s):-1,c={0:4,2:3,1:2,"-1":1},x=t.reduce((a,y)=>{const k=c[String(y.status)]||0,N=c[String(a)]||0;return k>N?y.status:a},t[0].status),n=t.reduce((a,y)=>(y.statusCounts&&Object.keys(y.statusCounts).forEach(k=>{const N=k;a[N]=(a[N]||0)+(y.statusCounts[N]||0)}),a),{}),b=t[0],u=t.map(a=>a.latency).filter(a=>a>0),o=u.length>0?Math.round(u.reduce((a,y)=>a+y,0)/u.length):0,v={index:b.index,status:x,timestamp:b.timestamp,timestampNum:b.timestampNum,latency:o,availability:l,statusCounts:n};return v._aggregated=!0,v._originalPoints=t,v._minAvailability=r,v._maxAvailability=i,v}function Ce({item:t,slowLatencyMs:s,showCategoryTag:l=!0,showProvider:r=!0,showSponsor:i=!0,onBlockHover:c,onBlockLeave:x}){const{t:n,i18n:b}=C(),[u,o]=g.useState(!1),v=oe(n),a=g.useMemo(()=>Le(t.history,30),[t.history]);return e.jsxs("div",{className:"bg-slate-800/60 border border-slate-800 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 flex-shrink-0 rounded-lg bg-slate-800 flex items-center justify-center border border-slate-700",children:t.serviceType==="cc"?e.jsx(re,{className:"text-amber-400",size:18}):e.jsx(le,{className:"text-orange-400",size:18})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r&&e.jsx("span",{className:"font-semibold text-slate-100 truncate",children:e.jsx(P,{href:t.providerUrl,children:t.providerName})}),l&&e.jsx("span",{className:`flex-shrink-0 px-1.5 py-0.5 rounded text-[10px] font-semibold uppercase ${t.category==="commercial"?"text-emerald-300 bg-emerald-500/10 border border-emerald-500/30":"text-cyan-300 bg-cyan-500/10 border border-cyan-500/30"}`,children:t.category==="commercial"?n("table.categoryShort.promoted"):n("table.categoryShort.charity")})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-slate-400",children:[e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-mono border ${t.serviceType==="cc"?"border-amber-500/30 text-amber-300 bg-amber-500/10":"border-orange-500/30 text-orange-300 bg-orange-500/10"}`,children:t.serviceType.toUpperCase()}),t.channel&&e.jsx("span",{className:"text-slate-500 truncate",children:t.channel})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 rounded-full bg-slate-800 border border-slate-700",children:[e.jsx(ce,{status:t.currentStatus,size:"sm"}),e.jsx("span",{className:`text-xs font-bold ${v[t.currentStatus].text}`,children:v[t.currentStatus].label})]}),e.jsx("span",{className:"text-sm font-mono font-bold",style:{color:G(t.uptime)},children:t.uptime>=0?`${t.uptime}%`:"--"})]})]}),e.jsx("div",{className:"flex gap-[2px] h-6 w-full",children:a.map((y,k)=>e.jsx(me,{point:y,width:`${100/a.length}%`,height:"h-full",onHover:c,onLeave:x},k))}),e.jsx("button",{onClick:()=>o(!u),className:"w-full flex items-center justify-center gap-1 py-1.5 text-xs text-slate-500 hover:text-slate-300 transition-colors",children:u?e.jsxs(e.Fragment,{children:[e.jsx(ye,{size:14}),n("table.collapseDetails")]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{size:14}),n("table.expandDetails")]})}),u&&e.jsxs("div",{className:"pt-3 border-t border-slate-800 space-y-2 text-xs",children:[i&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:n("common.sponsor")}),e.jsx("span",{className:"text-slate-300",children:e.jsx(P,{href:t.sponsorUrl,children:t.sponsor})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:n("common.channel")}),e.jsx("span",{className:"text-slate-300",children:t.channel||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:n("common.lastCheck")}),e.jsx("span",{className:"text-slate-300 font-mono",children:t.lastCheckTimestamp?new Date(t.lastCheckTimestamp*1e3).toLocaleString(b.language,{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"})]}),t.lastCheckLatency!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:n("common.latency")}),e.jsxs("span",{className:"font-mono",style:{color:q(t.lastCheckLatency,s)},children:[t.lastCheckLatency,"ms"]})]})]})]})}function De({sortConfig:t,onSort:s}){const{t:l}=C(),r=[{key:"providerName",label:l("table.sorting.provider")},{key:"uptime",label:l("table.sorting.uptime")},{key:"currentStatus",label:l("table.sorting.status")},{key:"serviceType",label:l("table.sorting.service")}];return e.jsxs("div",{className:"flex items-center gap-2 mb-4 overflow-x-auto pb-2",children:[e.jsx("span",{className:"text-xs text-slate-500 flex-shrink-0",children:l("controls.sortBy")}),r.map(i=>e.jsxs("button",{onClick:()=>s(i.key),className:`flex items-center gap-1 px-2.5 py-1.5 rounded-lg text-xs font-medium transition-colors flex-shrink-0 ${t.key===i.key?"bg-amber-500/20 text-amber-300 border border-amber-500/30":"bg-slate-800 text-slate-400 border border-slate-700 hover:text-slate-200"}`,children:[i.label,t.key===i.key&&(t.direction==="asc"?e.jsx(ne,{size:12}):e.jsx(ie,{size:12}))]},i.key))]})}function Fe({data:t,sortConfig:s,timeRange:l,slowLatencyMs:r,showCategoryTag:i=!0,showProvider:c=!0,showSponsor:x=!0,onSort:n,onBlockHover:b,onBlockLeave:u}){const{t:o,i18n:v}=C(),[a,y]=g.useState(!1),k=oe(o);g.useEffect(()=>Y("tablet",y),[]);const N=({columnKey:d})=>s.key!==d?e.jsx(Ne,{size:14,className:"opacity-30 ml-1"}):s.direction==="asc"?e.jsx(ne,{size:14,className:"text-amber-400 ml-1"}):e.jsx(ie,{size:14,className:"text-amber-400 ml-1"}),L=Ae(o).find(d=>d.id===l);return a?e.jsxs("div",{children:[e.jsx(De,{sortConfig:s,onSort:n}),e.jsx("div",{className:"space-y-3",children:t.map(d=>e.jsx(Ce,{item:d,slowLatencyMs:r,showCategoryTag:i,showProvider:c,showSponsor:x,onBlockHover:b,onBlockLeave:u},d.id))})]}):e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-800/50 shadow-xl",children:e.jsxs("table",{className:"w-full text-left border-collapse bg-slate-800/40 backdrop-blur-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700/50 text-slate-400 text-xs uppercase tracking-wider",children:[c&&e.jsx("th",{className:"p-4 font-medium cursor-pointer hover:text-amber-400 transition-colors",onClick:()=>n("providerName"),children:e.jsxs("div",{className:"flex items-center",children:[o("table.headers.provider")," ",e.jsx(N,{columnKey:"providerName"})]})}),x&&e.jsx("th",{className:"p-4 font-medium cursor-pointer hover:text-amber-400 transition-colors",onClick:()=>n("sponsor"),children:e.jsxs("div",{className:"flex items-center",children:[o("table.headers.sponsor")," ",e.jsx(N,{columnKey:"sponsor"})]})}),e.jsx("th",{className:"p-4 font-medium cursor-pointer hover:text-amber-400 transition-colors",onClick:()=>n("serviceType"),children:e.jsxs("div",{className:"flex items-center",children:[o("table.headers.service")," ",e.jsx(N,{columnKey:"serviceType"})]})}),e.jsx("th",{className:"p-4 font-medium cursor-pointer hover:text-amber-400 transition-colors",onClick:()=>n("channel"),children:e.jsxs("div",{className:"flex items-center",children:[o("table.headers.channel")," ",e.jsx(N,{columnKey:"channel"})]})}),e.jsx("th",{className:"p-4 font-medium cursor-pointer hover:text-amber-400 transition-colors",onClick:()=>n("currentStatus"),children:e.jsxs("div",{className:"flex items-center",children:[o("table.headers.status")," ",e.jsx(N,{columnKey:"currentStatus"})]})}),e.jsx("th",{className:"p-4 font-medium cursor-pointer hover:text-amber-400 transition-colors",onClick:()=>n("uptime"),children:e.jsxs("div",{className:"flex items-center",children:[o("table.headers.uptime")," ",e.jsx(N,{columnKey:"uptime"})]})}),e.jsx("th",{className:"p-4 font-medium",children:o("table.headers.lastCheck")}),e.jsx("th",{className:"p-4 font-medium w-1/3 min-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[o("table.headers.trend"),e.jsx("span",{className:"text-[10px] normal-case opacity-50 border border-slate-700 px-1 rounded",children:L?.label})]})})]})}),e.jsx("tbody",{className:"divide-y divide-slate-800/50 text-sm",children:t.map(d=>e.jsxs("tr",{className:"group hover:bg-slate-800/40 transition-[background-color,color]",children:[c&&e.jsx("td",{className:"p-4 font-medium text-slate-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{href:d.providerUrl,children:d.providerName}),i&&e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-semibold uppercase tracking-wide ${d.category==="commercial"?"text-emerald-300 bg-emerald-500/10 border border-emerald-500/30":"text-cyan-300 bg-cyan-500/10 border border-cyan-500/30"}`,title:d.category==="commercial"?o("table.categoryLabels.promoted"):o("table.categoryLabels.charity"),children:d.category==="commercial"?o("table.categoryShort.promoted"):o("table.categoryShort.charity")})]})}),x&&e.jsx("td",{className:"p-4 text-slate-300 text-sm",children:e.jsx(P,{href:d.sponsorUrl,children:d.sponsor})}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-mono border ${d.serviceType==="cc"?"border-amber-500/30 text-amber-300 bg-amber-500/10":"border-orange-500/30 text-orange-300 bg-orange-500/10"}`,children:[d.serviceType==="cc"&&e.jsx(re,{size:10,className:"mr-1"}),d.serviceType==="cx"&&e.jsx(le,{size:10,className:"mr-1"}),d.serviceType.toUpperCase()]})}),e.jsx("td",{className:"p-4 text-slate-400 text-xs",children:d.channel||"-"}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{status:d.currentStatus,size:"sm"}),e.jsx("span",{className:k[d.currentStatus].text,children:k[d.currentStatus].label})]})}),e.jsx("td",{className:"p-4 font-mono font-bold",children:e.jsx("span",{style:{color:G(d.uptime)},children:d.uptime>=0?`${d.uptime}%`:"--"})}),e.jsx("td",{className:"p-4",children:d.lastCheckTimestamp?e.jsxs("div",{className:"text-xs text-slate-400 font-mono flex flex-col gap-0.5",children:[e.jsx("span",{children:new Date(d.lastCheckTimestamp*1e3).toLocaleString(v.language,{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}),d.lastCheckLatency!==void 0&&e.jsxs("span",{className:"text-[10px] font-mono",style:{color:q(d.lastCheckLatency,r)},children:[d.lastCheckLatency,"ms"]})]}):e.jsx("span",{className:"text-slate-600 text-xs",children:"-"})}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"flex gap-[2px] h-6 w-full max-w-xs",children:d.history.map((E,D)=>e.jsx(me,{point:E,width:`${100/d.history.length}%`,height:"h-full",onHover:b,onLeave:u},D))})})]},d.id))})]})})}function Ke({tooltip:t,slowLatencyMs:s,onClose:l}){const{t:r,i18n:i}=C(),[c,x]=g.useState(!1);if(g.useEffect(()=>Y("mobile",x),[]),!t.show||!t.data)return null;const n=t.data.statusCounts??{available:0,degraded:0,unavailable:0,slow_latency:0,rate_limit:0,server_error:0,client_error:0,auth_error:0,invalid_request:0,network_error:0,content_mismatch:0},b=[{key:"available",emoji:"ðŸŸ¢",label:r("status.available"),value:n.available},{key:"degraded",emoji:"ðŸŸ¡",label:r("status.degraded"),value:n.degraded},{key:"unavailable",emoji:"ðŸ”´",label:r("status.unavailable"),value:n.unavailable}],u=[{key:"slow_latency",label:r("subStatus.slow_latency"),value:n.slow_latency}].filter(a=>a.value>0),o=[{key:"server_error",label:r("subStatus.server_error"),value:n.server_error},{key:"client_error",label:r("subStatus.client_error"),value:n.client_error},{key:"auth_error",label:r("subStatus.auth_error"),value:n.auth_error},{key:"invalid_request",label:r("subStatus.invalid_request"),value:n.invalid_request},{key:"network_error",label:r("subStatus.network_error"),value:n.network_error},{key:"rate_limit",label:r("subStatus.rate_limit"),value:n.rate_limit},{key:"content_mismatch",label:r("subStatus.content_mismatch"),value:n.content_mismatch}].filter(a=>a.value>0),v=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-slate-400 text-center",children:new Date(t.data.timestampNum*1e3).toLocaleString(i.language)}),t.data.availability>=0&&e.jsxs("div",{className:"font-medium text-center text-sm md:text-xs",style:{color:G(t.data.availability)},children:[r("tooltip.uptime")," ",t.data.availability.toFixed(2),"%"]}),t.data.latency>0&&e.jsxs("div",{className:"text-[10px] text-center",children:[e.jsxs("span",{className:"text-slate-500",children:[r("tooltip.latency")," "]}),e.jsxs("span",{style:{color:q(t.data.latency,s)},children:[t.data.latency,"ms"]})]}),e.jsx("div",{className:"flex flex-col gap-1 pt-2 border-t border-slate-700/50",children:b.map(a=>e.jsxs("div",{className:"flex justify-between items-center gap-3 text-[11px]",children:[e.jsxs("span",{className:"text-slate-300",children:[a.emoji," ",a.label]}),e.jsxs("span",{className:"text-slate-100 font-semibold tabular-nums",children:[a.value," ",r("tooltip.count")]})]},a.key))}),u.length>0&&e.jsxs("div",{className:"flex flex-col gap-1 pt-2 border-t border-slate-700/50",children:[e.jsx("div",{className:"text-[10px] text-slate-400 mb-0.5",children:r("tooltip.degradedTitle")}),u.map(a=>e.jsxs("div",{className:"flex justify-between items-center gap-3 text-[10px] pl-2",children:[e.jsxs("span",{className:"text-slate-400",children:["â€¢ ",a.label]}),e.jsx("span",{className:"text-slate-200 tabular-nums",children:a.value})]},a.key))]}),o.length>0&&e.jsxs("div",{className:"flex flex-col gap-1 pt-2 border-t border-slate-700/50",children:[e.jsx("div",{className:"text-[10px] text-slate-400 mb-0.5",children:r("tooltip.unavailableTitle")}),o.map(a=>e.jsxs("div",{className:"flex justify-between items-center gap-3 text-[10px] pl-2",children:[e.jsxs("span",{className:"text-slate-400",children:["â€¢ ",a.label]}),e.jsx("span",{className:"text-slate-200 tabular-nums",children:a.value})]},a.key))]})]});return c?e.jsxs("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",onClick:l,children:[e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-slate-900 border-t border-slate-700 rounded-t-2xl p-4 pb-6 animate-slide-up",onClick:a=>a.stopPropagation(),style:{animation:"slideUp 0.2s ease-out"},children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("div",{className:"w-10 h-1 bg-slate-700 rounded-full"})}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-200",children:r("tooltip.title")}),e.jsx("button",{onClick:l,className:"p-1.5 rounded-lg bg-slate-800 text-slate-400 hover:text-slate-200 transition-colors","aria-label":r("common.close"),children:e.jsx(we,{size:16})})]}),e.jsx("div",{className:"flex flex-col gap-2 text-xs",children:e.jsx(v,{})})]}),e.jsx("style",{children:`
          @keyframes slideUp {
            from {
              transform: translateY(100%);
            }
            to {
              transform: translateY(0);
            }
          }
        `})]}):e.jsx("div",{className:"fixed z-50 pointer-events-none transition-opacity duration-200",style:{left:t.x,top:t.y,transform:"translate(-50%, -100%)"},children:e.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-md text-slate-200 text-xs p-3 rounded-lg border border-slate-700 shadow-[0_10px_40px_-10px_rgba(0,0,0,0.8)] flex flex-col gap-2 min-w-[180px]",children:[e.jsx(v,{}),e.jsx("div",{className:"absolute -bottom-1.5 left-1/2 -translate-x-1/2 w-3 h-3 bg-slate-900 border-r border-b border-slate-700 transform rotate-45"})]})})}function He(){return e.jsx("footer",{className:"fixed bottom-0 left-0 right-0 w-full bg-slate-900/95 border-t border-slate-700/50 backdrop-blur-sm z-20",children:e.jsx("p",{className:"text-xs text-slate-500 text-center py-2 px-4",children:e.jsx("a",{href:"https://beian.miit.gov.cn/",target:"_blank",rel:"noopener noreferrer",className:"hover:text-slate-400 transition-colors",children:"æ²ªICPå¤‡2025148260å·"})})})}function $e(t){return new Promise(s=>{setTimeout(()=>{const l=J.find(c=>c.id===t)||J[0];if(!l){console.error(`Invalid timeRangeId: ${t}, falling back to default`),s([]);return}const r=l.points,i=[];ke.forEach((c,x)=>{c.services.forEach(n=>{const b=Array.from({length:r}).map((p,h)=>{const j=Math.random();let m="AVAILABLE";j>.98?m="MISSING":j>.95?m="UNAVAILABLE":j>.85&&(m="DEGRADED");const A=m==="MISSING"?0:180+Math.floor(Math.random()*220);let w;m==="MISSING"?w=-1:m==="AVAILABLE"?w=80+Math.random()*20:m==="DEGRADED"?w=60+Math.random()*20:w=Math.random()*60;const T=Date.now()-(r-h)*(l.unit==="hour"?36e5:864e5),_={available:m==="AVAILABLE"?1:0,degraded:m==="DEGRADED"?1:0,unavailable:m==="UNAVAILABLE"?1:0,missing:m==="MISSING"?1:0,slow_latency:0,rate_limit:0,server_error:0,client_error:0,auth_error:0,invalid_request:0,network_error:0,content_mismatch:0};if(m==="DEGRADED")Math.random()>.5?_.slow_latency=1:_.rate_limit=1;else if(m==="UNAVAILABLE"){const f=Math.random();f>.75?_.server_error=1:f>.5?_.client_error=1:f>.25?_.network_error=1:_.content_mismatch=1}return{index:h,status:m,timestamp:new Date(T).toISOString(),timestampNum:Math.floor(T/1e3),latency:A,availability:w,statusCounts:_}}),u=b[b.length-1].status,o=b.filter(p=>p.availability>=0),v=o.length>0?parseFloat((o.reduce((p,h)=>p+h.availability,0)/o.length).toFixed(2)):-1,a=["vip-channel","standard-channel","test-channel"],y=a[x%a.length],N=["commercial","public"][x%2],L=["å›¢é˜Ÿè‡ªæœ‰","ç¤¾åŒºèµžåŠ©","duckcodingå®˜æ–¹","ç¤ºä¾‹æ•°æ®"],d=L[x%L.length],E=Math.floor(Date.now()/1e3),D=180+Math.floor(Math.random()*220);i.push({id:`${c.id}-${n}`,providerId:c.id,providerSlug:c.id,providerName:c.name,serviceType:n,category:N,sponsor:d,channel:y,history:b,currentStatus:u,uptime:v,lastCheckTimestamp:E,lastCheckLatency:D})})}),s(i)},600)})}function ee(t){if(!t||t.trim()==="")return null;try{return new URL(t),t}catch{return console.warn(`Invalid URL: ${t}`),null}}function te(t){return t?.trim().toLowerCase()??""}function Ue(t){const s=t?.trim();return s?s.charAt(0).toUpperCase()+s.slice(1):be.t("common.unknownProvider")}const se={1:"AVAILABLE",2:"DEGRADED",0:"UNAVAILABLE",3:"MISSING","-1":"MISSING"},Re=t=>({available:t?.available??0,degraded:t?.degraded??0,unavailable:t?.unavailable??0,missing:t?.missing??0,slow_latency:t?.slow_latency??0,rate_limit:t?.rate_limit??0,server_error:t?.server_error??0,client_error:t?.client_error??0,auth_error:t?.auth_error??0,invalid_request:t?.invalid_request??0,network_error:t?.network_error??0,content_mismatch:t?.content_mismatch??0});function Oe({timeRange:t,filterService:s,filterProvider:l,filterChannel:r,filterCategory:i,sortConfig:c}){const[x,n]=g.useState(!0),[b,u]=g.useState(null),[o,v]=g.useState([]),[a,y]=g.useState(0),[k,N]=g.useState(5e3);g.useEffect(()=>{let p=!0;return(async()=>{n(!0),u(null);const j=F?0:performance.now();try{let m;if(F)m=await $e(t);else{const A=`${Se}/api/status?period=${t}`,w=await fetch(A),T=Math.round(performance.now()-j);if(!w.ok)throw K("/api/status",T,!1),Q("/api/status",`HTTP_${w.status}`,"HTTP Error"),new Error(`HTTP error! status: ${w.status}`);const _=await w.json();K("/api/status",T,!0),_.meta.slow_latency_ms&&_.meta.slow_latency_ms>0&&N(_.meta.slow_latency_ms),m=_.data.map(f=>{const Z=f.timeline.map((S,V)=>({index:V,status:se[S.status]||"UNAVAILABLE",timestamp:S.time,timestampNum:S.timestamp,latency:S.latency,availability:S.availability,statusCounts:Re(S.status_counts)})),xe=f.current_status&&se[f.current_status.status]||"UNAVAILABLE",B=Z.filter(S=>S.availability>=0),he=B.length>0?parseFloat((B.reduce((S,V)=>S+V.availability,0)/B.length).toFixed(2)):-1,X=te(f.provider),pe=Ue(f.provider);return{id:`${X||f.provider}-${f.service}-${f.channel||"default"}`,providerId:X||f.provider,providerSlug:f.provider_slug||te(f.provider),providerName:pe,providerUrl:ee(f.provider_url),serviceType:f.service,category:f.category,sponsor:f.sponsor,sponsorUrl:ee(f.sponsor_url),channel:f.channel||void 0,history:Z,currentStatus:xe,uptime:he,lastCheckTimestamp:f.current_status?.timestamp,lastCheckLatency:f.current_status?.latency}})}if(!p)return;v(m)}catch(m){if(!p)return;const A=m instanceof Error?m.message:"Unknown error";if(u(A),!F&&!A.startsWith("HTTP error!")){const w=Math.round(performance.now()-j);K("/api/status",w,!1),Q("/api/status","NETWORK_ERROR","Network failure")}}finally{p&&n(!1)}})(),()=>{p=!1}},[t,a]);const L=g.useMemo(()=>{const p=new Set;return o.forEach(h=>{h.channel&&p.add(h.channel)}),Array.from(p).sort()},[o]),d=g.useMemo(()=>{const p=new Map;return o.forEach(h=>{h.providerId&&(p.has(h.providerId)||p.set(h.providerId,h.providerName))}),Array.from(p.entries()).sort((h,j)=>h[1].localeCompare(j[1],"zh-CN")).map(([h,j])=>({value:h,label:j}))},[o]),E=g.useMemo(()=>{const p=o.filter(h=>i==="all");return c.key&&p.sort((h,j)=>{let m=h[c.key],A=j[c.key];if(c.key==="currentStatus"&&(m=O[h.currentStatus].weight,A=O[j.currentStatus].weight),c.key==="uptime"){const w=T=>T<0?c.direction==="asc"?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:T;m=w(h.uptime),A=w(j.uptime)}return m<A?c.direction==="asc"?-1:1:m>A?c.direction==="asc"?1:-1:0}),p},[o,s,l,r,i,c]),D=g.useMemo(()=>{const p=E.length,h=E.filter(m=>m.currentStatus==="AVAILABLE").length,j=p-h;return{total:p,healthy:h,issues:j}},[E]);return{loading:x,error:b,data:E,stats:D,channels:L,providers:d,slowLatencyMs:k,refetch:()=>{n(!0),y(p=>p+1)}}}export{P as E,He as F,me as H,ce as S,Ke as T,Le as a,oe as b,G as c,Ve as d,Fe as e,Ae as g,q as l,Oe as u};
