import{j as e}from"./index-lyjpRGYG.js";import{r as d,c as B}from"./router-Bv_Qn1wY.js";import{a as F}from"./helmet-CzrW8xDS.js";import{g as z,a as _,b as A,E as U,c as E,S as K,l as V,H as I,u as Z,T as G,d as O,e as Y,F as q}from"./useMonitorData-SjrYSc1V.js";import{u as T}from"./i18n-CHCxKNI1.js";import{L as J,a as Q,R as W,Z as X,S as ee,A as te,b as se,c as L}from"./icons-DIKtrEYc.js";import"./react-vendor-OvXVS5lI.js";function re({timeRange:t,viewMode:o,loading:h,onTimeRangeChange:r,onViewModeChange:c,onRefresh:f}){const{t:l}=T();return e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[e.jsx("div",{className:"flex-1 bg-slate-800/40 p-2 rounded-2xl border border-slate-800/50 backdrop-blur-md flex items-center gap-1 overflow-x-auto scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-transparent",children:z(l).map(i=>e.jsx("button",{onClick:()=>r(i.id),className:`px-3 py-2 text-xs font-medium rounded-xl transition-all duration-200 whitespace-nowrap flex-shrink-0 ${t===i.id?"bg-gradient-to-br from-amber-500 to-orange-600 text-white shadow-lg shadow-amber-500/25":"text-slate-400 hover:text-slate-200 hover:bg-slate-800"}`,children:i.label},i.id))}),e.jsxs("div",{className:"bg-slate-800/40 p-2 rounded-2xl border border-slate-800/50 backdrop-blur-md flex items-center gap-2",children:[e.jsxs("div",{className:"flex bg-slate-800 rounded-lg p-1 border border-slate-700",children:[e.jsx("button",{onClick:()=>c("table"),className:`p-2.5 rounded min-w-[44px] min-h-[44px] flex items-center justify-center ${o==="table"?"bg-slate-700 text-amber-400 shadow":"text-slate-400 hover:text-slate-200"}`,title:l("controls.views.table"),"aria-label":l("controls.views.switchToTable"),children:e.jsx(J,{size:18})}),e.jsx("button",{onClick:()=>c("grid"),className:`p-2.5 rounded min-w-[44px] min-h-[44px] flex items-center justify-center ${o==="grid"?"bg-slate-700 text-amber-400 shadow":"text-slate-400 hover:text-slate-200"}`,title:l("controls.views.card"),"aria-label":l("controls.views.switchToCard"),children:e.jsx(Q,{size:18})})]}),e.jsx("button",{onClick:f,className:"p-2.5 rounded-lg bg-amber-500/10 text-amber-400 hover:bg-amber-500/20 transition-colors border border-amber-500/20 group min-w-[44px] min-h-[44px] flex items-center justify-center",title:l("common.refresh"),"aria-label":l("common.refresh"),children:e.jsx(W,{size:18,className:`transition-transform ${h?"animate-spin":"group-hover:rotate-180"}`})})]})]})}function ae({item:t,timeRange:o,slowLatencyMs:h,showCategoryTag:r,showProvider:c=!0,onBlockHover:f,onBlockLeave:l}){const{t:i,i18n:b}=T(),g=d.useMemo(()=>_(t.history,50),[t.history]),p=A(i),j=z(i).find(s=>s.id===o);return e.jsxs("div",{className:"group relative bg-slate-800/60 border border-slate-800 hover:border-amber-500/30 rounded-2xl p-4 sm:p-6 transition-all duration-300 hover:shadow-[0_0_30px_rgba(245,158,11,0.1)] backdrop-blur-sm overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 w-full h-1 ${p[t.currentStatus].color}`}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_auto] gap-4 mb-6",children:[e.jsxs("div",{className:"flex gap-3 sm:gap-4 items-start sm:items-center",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 flex-shrink-0 rounded-xl bg-slate-800 flex items-center justify-center border border-slate-700 group-hover:border-slate-600 transition-colors",children:t.serviceType==="cc"?e.jsx(X,{className:"text-amber-400",size:20}):e.jsx(ee,{className:"text-orange-400",size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c&&e.jsx("h3",{className:"text-base sm:text-lg font-bold text-slate-100",children:e.jsx(U,{href:t.providerUrl,children:t.providerName})}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-mono border flex-shrink-0 ${t.serviceType==="cc"?"border-amber-500/30 text-amber-300 bg-amber-500/10":"border-orange-500/30 text-orange-300 bg-orange-500/10"}`,children:t.serviceType.toUpperCase()})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs font-mono",children:[e.jsx(te,{size:12,className:"text-slate-400"}),e.jsxs("span",{style:{color:E(t.uptime)},children:[i("card.uptime")," ",t.uptime>=0?`${t.uptime}%`:"--"]})]})]})]}),e.jsxs("div",{className:"flex sm:flex-col items-start sm:items-end gap-2 sm:gap-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 sm:py-1 rounded-full bg-slate-800 border border-slate-700",children:[e.jsx(K,{status:t.currentStatus}),e.jsx("span",{className:`text-xs font-bold ${p[t.currentStatus].text}`,children:p[t.currentStatus].label})]}),t.lastCheckTimestamp&&e.jsxs("div",{className:"text-[10px] text-slate-500 font-mono flex flex-col items-start sm:items-end gap-0.5",children:[e.jsx("span",{className:"whitespace-nowrap",children:new Date(t.lastCheckTimestamp*1e3).toLocaleString(b.language,{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}),t.lastCheckLatency!==void 0&&e.jsxs("span",{style:{color:V(t.lastCheckLatency,h)},children:[t.lastCheckLatency,"ms"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mb-2",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(se,{size:12})," ",j?.label||o]}),e.jsx("span",{children:i("common.now")})]}),e.jsx("div",{className:"flex gap-[3px] h-10 w-full",children:g.map((s,x)=>e.jsx(I,{point:s,width:`${100/g.length}%`,onHover:f,onLeave:l},x))}),g.length<t.history.length&&e.jsx("div",{className:"mt-2 text-[10px] text-slate-600 text-center sm:hidden",children:i("table.heatmapHint",{from:t.history.length,to:g.length})})]})]})}const a={timeRange:"24h",filterProvider:"all",filterService:"all",filterChannel:"all",filterCategory:"all",viewMode:"table",sortKey:"uptime",sortDirection:"desc"},n={timeRange:"period",filterProvider:"provider",filterService:"service",filterChannel:"channel",filterCategory:"category",viewMode:"view",sort:"sort"};function le(t){if(!t)return{key:a.sortKey,direction:a.sortDirection};const o=t.lastIndexOf("_");if(o===-1)return{key:t,direction:a.sortDirection};const h=t.substring(0,o),r=t.substring(o+1);return r==="asc"||r==="desc"?{key:h,direction:r}:{key:t,direction:a.sortDirection}}function M(t){return`${t.key}_${t.direction}`}function oe(){const[t,o]=B(),h=d.useMemo(()=>{const s=t.get(n.viewMode),x=s==="table"||s==="grid"?s:a.viewMode;return{timeRange:t.get(n.timeRange)||a.timeRange,filterProvider:t.get(n.filterProvider)||a.filterProvider,filterService:t.get(n.filterService)||a.filterService,filterChannel:t.get(n.filterChannel)||a.filterChannel,filterCategory:t.get(n.filterCategory)||a.filterCategory,viewMode:x,sortConfig:le(t.get(n.sort))}},[t]),r=d.useCallback((s,x,v)=>{o(w=>{const u=new URLSearchParams(w);return x===v?u.delete(s):u.set(s,x),u},{replace:!0})},[o]),c=d.useCallback(s=>{r(n.timeRange,s,a.timeRange)},[r]),f=d.useCallback(s=>{r(n.filterProvider,s,a.filterProvider)},[r]),l=d.useCallback(s=>{r(n.filterService,s,a.filterService)},[r]),i=d.useCallback(s=>{r(n.filterChannel,s,a.filterChannel)},[r]),b=d.useCallback(s=>{r(n.filterCategory,s,a.filterCategory)},[r]),g=d.useCallback(s=>{r(n.viewMode,s,a.viewMode)},[r]),p=d.useCallback(s=>{const x=M(s),v=M({key:a.sortKey,direction:a.sortDirection});r(n.sort,x,v)},[r]);return[h,{setTimeRange:c,setFilterProvider:f,setFilterService:l,setFilterChannel:i,setFilterCategory:b,setViewMode:g,setSortConfig:p}]}function fe(){const{t,i18n:o}=T(),[h,r]=oe(),{timeRange:c,viewMode:f,sortConfig:l}=h,{setTimeRange:i,setViewMode:b,setSortConfig:g}=r,p="all",j="all",s="all",x="all",[v,w]=d.useState({show:!1,x:0,y:0,data:null}),{loading:u,error:R,data:y,stats:$,slowLatencyMs:N}=Z({timeRange:c,filterService:j,filterProvider:p,filterChannel:s,filterCategory:x,sortConfig:l}),H=m=>{let C="desc";l.key===m&&l.direction==="desc"&&(C="asc"),g({key:m,direction:C})},D=()=>{window.location.reload()},P=(m,C)=>{const k=m.currentTarget.getBoundingClientRect();w({show:!0,x:k.left+k.width/2,y:k.top-10,data:C})},S=()=>{w(m=>({...m,show:!1}))};return e.jsxs(e.Fragment,{children:[e.jsxs(F,{children:[e.jsx("html",{lang:o.language}),e.jsx("title",{children:t("meta.title")}),e.jsx("meta",{name:"description",content:t("meta.description")})]}),e.jsxs("div",{className:"min-h-screen bg-slate-800 text-slate-200 font-sans selection:bg-amber-500 selection:text-white overflow-x-hidden",children:[e.jsx(G,{tooltip:v,onClose:S,slowLatencyMs:N}),e.jsxs("div",{className:"fixed top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-[600px] h-[600px] bg-amber-500/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-10%] left-[-10%] w-[600px] h-[600px] bg-amber-500/10 rounded-full blur-[120px]"})]}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-4 sm:py-6 sm:px-6 lg:px-8",children:[e.jsx(O,{stats:$}),e.jsx(re,{timeRange:c,viewMode:f,loading:u,onTimeRangeChange:i,onViewModeChange:b,onRefresh:D}),R?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-rose-400",children:[e.jsx(L,{size:64,className:"mb-4 opacity-20"}),e.jsx("p",{className:"text-lg",children:t("common.error",{message:R})})]}):u&&y.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-slate-500 gap-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-amber-500/20 border-t-amber-500 rounded-full animate-spin"}),e.jsx("p",{className:"animate-pulse",children:t("common.loading")})]}):y.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-600",children:[e.jsx(L,{size:64,className:"mb-4 opacity-20"}),e.jsx("p",{className:"text-lg",children:t("common.noData")})]}):f==="table"?e.jsx(Y,{data:y,sortConfig:l,timeRange:c,slowLatencyMs:N,showProvider:!1,showSponsor:!1,onSort:H,onBlockHover:P,onBlockLeave:S}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(m=>e.jsx(ae,{item:m,timeRange:c,slowLatencyMs:N,showProvider:!1,onBlockHover:P,onBlockLeave:S},`${m.providerId}-${m.serviceType}`))}),e.jsx(q,{})]})]})]})}export{fe as default};
